# Generated by Django 3.2.8 on 2021-10-19 09:14

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import django.db.models.expressions


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ResourcingApproval',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.SmallIntegerField(choices=[(0, 'Draft'), (1, 'Awaiting chief approval'), (2, 'Awaiting approvals'), (3, 'Approved')], default=0)),
                ('name', models.CharField(max_length=255)),
                ('is_ir35', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], null=True, verbose_name='Is the role inside IR35?')),
                ('chief_approval', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], null=True)),
                ('chief_approval_when', models.DateTimeField(null=True)),
                ('hrbp_approval', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], null=True, verbose_name='HRBP approval')),
                ('hrbp_approval_when', models.DateTimeField(null=True)),
                ('finance_approval', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], null=True)),
                ('finance_approval_when', models.DateTimeField(null=True)),
                ('commercial_approval', models.BooleanField(choices=[(True, 'Yes'), (False, 'No')], null=True)),
                ('commercial_approval_when', models.DateTimeField(null=True)),
                ('chief', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('chief_approval_who', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('commercial_approval_who', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('finance_approval_who', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('hrbp_approval_who', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('requestor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='approvals', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'permissions': (('can_give_chief_approval', 'Can give chief approval'), ('can_give_hrbp_approval', 'Can give HRBP approval'), ('can_give_finance_approval', 'Can give finance approval'), ('can_give_commercial_approval', 'Can give commercial approval')),
            },
        ),
        migrations.CreateModel(
            name='StatementOfWork',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('company_name', models.CharField(max_length=255)),
                ('approval', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='statement_of_work', to='main.resourcingapproval')),
            ],
        ),
        migrations.CreateModel(
            name='SdsStatusDetermination',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('todo', models.TextField()),
                ('approval', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='sds_status_determination', to='main.resourcingapproval')),
            ],
        ),
        migrations.CreateModel(
            name='JobDescription',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=255, verbose_name='Vacancy Title')),
                ('role_purpose', models.TextField(help_text='Use this space to outline what the person is responsible for delivering and how this contributes to the success of the department. More detail on this will be added in the next section.')),
                ('key_accountabilities', models.TextField(help_text='Outline what the individual needs to do in order to achieve to deliverables outlined above.')),
                ('line_management_responsibility', models.TextField()),
                ('personal_attributes_and_skills', models.TextField(help_text='Insert information about what the ideal candidate would be like in their character and what theyâ€™d bring to your team. This will enhance our search ability and interview quality.')),
                ('essential_and_preferred_experience', models.TextField(help_text='You must ensure the successful candidate meets your specification entirely, so do not put expectations that are not vital.\n\nThe diversity of applicants you receive to roles increases when shorter lists of personal and experience requirements are listed, which creates a better pool of candidates to select from at interview.')),
                ('approval', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='job_description', to='main.resourcingapproval')),
            ],
        ),
        migrations.CreateModel(
            name='InterimRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('todo', models.TextField()),
                ('approval', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='interim_request', to='main.resourcingapproval')),
            ],
        ),
        migrations.CreateModel(
            name='Comment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('text', models.TextField(verbose_name='Add a comment')),
                ('approval', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comments', to='main.resourcingapproval')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comments', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='CestRationale',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('todo', models.TextField()),
                ('approval', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='cest_rationale', to='main.resourcingapproval')),
            ],
        ),
        migrations.AddIndex(
            model_name='resourcingapproval',
            index=models.Index(fields=['status'], name='status_index'),
        ),
        migrations.AddConstraint(
            model_name='resourcingapproval',
            constraint=models.CheckConstraint(check=models.Q(models.Q(('chief_approval__isnull', True), ('commercial_approval__isnull', True), ('finance_approval__isnull', True), ('hrbp_approval__isnull', True), ('status', 0)), ('status', 1), models.Q(('chief_approval', True), ('status', 2)), models.Q(('chief_approval', True), ('commercial_approval', True), ('finance_approval', True), ('hrbp_approval', True), ('status', 3)), _connector='OR'), name='check_status'),
        ),
        migrations.AddConstraint(
            model_name='resourcingapproval',
            constraint=models.CheckConstraint(check=models.Q(('chief_approval_who', django.db.models.expressions.F('chief'))), name='check_chief'),
        ),
    ]
